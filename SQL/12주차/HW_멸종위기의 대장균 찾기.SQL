WITH RECURSIVE GENERATION AS (
    SELECT ID, PARENT_ID, 1 AS GEN
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NULL -- 최초 세대(루트 노드)

    UNION ALL

    SELECT e.ID, e.PARENT_ID, g.GEN + 1 AS GEN
    FROM ECOLI_DATA e
             JOIN GENERATION g ON e.PARENT_ID = g.ID -- 부모-자식 연결
)
SELECT COUNT(*) AS COUNT, GEN AS GENERATION
FROM GENERATION g
WHERE NOT EXISTS (
    SELECT 1
    FROM ECOLI_DATA e
    WHERE e.PARENT_ID = g.ID -- 자식 노드가 없는 경우만 선택
    )
GROUP BY GEN -- 자식이 없는 노드를 세대별로 그룹화
ORDER BY GEN;